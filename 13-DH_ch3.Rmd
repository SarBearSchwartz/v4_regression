# D&H Ch3a - Multiple Regression: "Weight"


Darlington & Hayes, Chapter 3's first example

> Darlington, Richard B., and Andrew F. Hayes. Regression Analysis and Linear Models : Concepts, Applications, and Implementation, Guilford Publications, 2016. ProQuest Ebook Central, http://ebookcentral.proquest.com/lib/usu/detail.action?docID=4652287.
Created from usu on 2025-01-29 01:13:21.

```{block type='rmdlink', echo=TRUE}
Outside resource
* https://www.harshaash.com/R/part-and-partial-corr/
* https://dstanley4.github.io/psyc4780bookdown/multiple-regression.html

Reference:

* Knapp, T. R. (1996). [Semi-Partial Correlations: I Don't Need Them; You Can Have Them.](https://scholarworks.bgsu.edu/cgi/viewcontent.cgi?article=1631&context=mwer) Mid-Western Educational Researcher, 9(4), 4.
```


```{r}
# install.packages("remotes")
# remotes::install_github("sarbearschwartz/apaSupp")
# remotes::install_github("ddsjoberg/gtsummary")

library(magrittr)       
library(tidyverse)   
library(broom)     
library(naniar)
library(corrplot)   
library(GGally)
library(gtsummary)
library(apaSupp)
library(performance)
library(interactions)
library(effects)
library(emmeans)
library(car)
library(ggResidpanel)
library(modelsummary)
library(ppcor)
library(jtools)
library(olsrr)
library(DescTools)
library(effectsize)
library(ggpubr)
```




## PURPOSE

### Research Question

> How is weight loss associationed with exercise frequency and food intake? 


### Data Description

Suppose you conducted a study examining the relationship between food consumption and weight loss among people enrolled (`n` = 10) in a month-long healthy living class.

#### Variables

* `exer` average weekly hours of exercise
* `diet` average daily food consumption (in 100s of calories about the recommended minimum of 1,000 calories required to maintain good health)
* `loss` average weight loss in hundreds of grams per week



```{block type='rmdlightbulb', echo=TRUE}
Manually enter the data set provided on page 44 in Table 3.1
```


```{r}
df_loss <- tibble::tribble(~id, ~exer, ~diet, ~meta, ~loss,
                           1, 0, 2, 15,  6, 
                           2, 0, 4, 14,  2,
                           3, 0, 6, 19,  4,
                           4, 2, 2, 15,  8,
                           5, 2, 4, 21,  9,
                           6, 2, 6, 23,  8,
                           7, 2, 8, 21,  5,
                           8, 4, 4, 22, 11,
                           9, 4, 6, 24, 13,
                           10, 4, 8, 26,  9)
```



```{r}
df_loss %>% 
  dplyr::select("ID" = id,
                "Exercise\nFrequency" = exer,
                "Food\nIntake" = diet,
                "Weight\nLoss" = loss) %>% 
  flextable::flextable() %>% 
  apaSupp::theme_apa(caption = "D&H Table 3.1: Exercise, Food Intake, and Weight Loss") %>% 
  flextable::colformat_double(digits = 0) %>% 
  flextable::footnote(part = "header", 
                      i = 1, j = 2:4, 
                      value = as_paragraph(c("Weekly average of hours/day",
                                             "Daily average of 100s of calories above recommendation",
                                             "Weekly average of 100s of grams/week")))
```



## EXPLORATORY DATA ANALYSIS

### Summary Statistics

```{r}
df_loss %>% 
  dplyr::select("Exercise Frequency" = exer,
                "Food Intake" = diet,
                "Weight Loss" = loss,
                "Metabolic Rate" = meta) %>% 
  apaSupp::tab_desc(caption = "Summary Statistics") %>% 
  flextable::footnote(i = 1:3, j = 1, 
                      value = as_paragraph(c("Weekly average of hours/day",
                                             "Daily average of 100s of calories above recommendation",
                                             "Weekly average of 100s of grams/week")))
```

### Correlation

```{r}
df_loss %>% 
  dplyr::select("Exercise Frequency" = exer,
                "Food Intake" = diet,
                "Weight Loss" = loss) %>% 
  apaSupp::tab_cor(caption = "Correlations")
```


### Visualizations

```{r, fig.cap= "D&H Figure 3.1 (page 45) An example with positive simple association and negative partial association - BASIC"}
df_loss %>% 
  ggplot(aes(x = diet,
             y = loss)) +
  geom_point(aes(shape = factor(exer))) 
```

```{r, fig.cap= "D&H Figure 3.1 (page 45) An example with positive simple association and negative partial association - BETTTER"}
df_loss %>% 
  ggplot(aes(x = diet,
             y = loss)) +
  geom_point(aes(shape = factor(exer),
                 color = factor(exer)),
             size = 3)  +
  theme_bw() +
  labs(x = "Observed Food Intake\nDaily average of 100s of calories above recommendation",
       y = "Observed Weight Loss\nWeekly average of 100s of grams/week",
       shape = "Exercise Frequency\nWeekly average of hours/day",
       color = "Exercise Frequency\nWeekly average of hours/day") +
  theme(legend.position = "bottom")
```

```{r, fig.cap= "D&H Figure 3.1 (page 45) An example with positive simple association and negative partial association - WORST"}
df_loss %>% 
  dplyr::mutate(exer = factor(exer)) %>% 
  ggplot(aes(x = diet,
             y = loss)) +
  geom_point(size = 3)  +
  theme_bw() +
  labs(x = "Observed Food Intake\n(Daily average of 100s of calories above recommendation)",
       y = "Observed Weight Loss\n(Weekly average of 100s of grams/week)",
       shape = "Exercise Frequency\n(Weekly average of hours/day)",
       color = "Exercise Frequency\n(Weekly average of hours/day)") +
  theme(legend.position = "bottom") +
  geom_smooth(aes(group = 1),
              method = "lm",
              formula = y ~ x,
              se = FALSE)
```


```{r, fig.cap= "D&H Figure 3.1 (page 45) An example with positive simple association and negative partial association - BEST"}
df_loss %>% 
  dplyr::mutate(exer = factor(exer)) %>% 
  ggplot(aes(x = diet,
             y = loss,
             group = exer)) +
  geom_point(aes(shape = exer,
                 color = exer),
             size = 3)  +
  theme_bw() +
  labs(x = "Observed Food Intake\n(Daily average of 100s of calories above recommendation)",
       y = "Observed Weight Loss\n(Weekly average of 100s of grams/week)",
       shape = "Exercise Frequency\n(Weekly average of hours/day)",
       color = "Exercise Frequency\n(Weekly average of hours/day)") +
  theme(legend.position = "bottom") +
  geom_smooth(aes(color = exer),
              method = "lm",
              formula = y ~ x,
              se = FALSE)
```



## REGRESSION ANALYSIS

### Fit the models

* The dependent variable (DV) is weight loss ($Y$)
* The independent variables (IVs) are exercise and diet ($X$)

```{r}
fit_lm_exer <- lm(loss ~ exer,
                  data = df_loss)

fit_lm_diet <- lm(loss ~ diet,
                  data = df_loss)

fit_lm_both <- lm(loss ~ exer + diet,
                  data = df_loss)

fit_lm_three<- lm(loss ~ exer + diet + meta,
                  data = df_loss)
```

### Output

```{r}
olsrr::ols_regress(fit_lm_exer)
```


```{r}
olsrr::ols_regress(fit_lm_diet)
```


```{r}
olsrr::ols_regress(fit_lm_both)
```



```{r}
olsrr::ols_regress(fit_lm_three)
```




### Equations

$$

\widehat{loss} = 4 + 1.75(exercise) \\

\widehat{loss} = 7.14 + 0.07(food) \\

\widehat{loss} = 6 + 2(exercise) -0.5(food) \\

\widehat{loss} = -1.636 + 1.045(exercise) -1.136(food) + 0.636(metabolism)\\

$$



### Tables


```{r}
tab_lm3 <- apaSupp::tab_lms(list(fit_lm_exer, fit_lm_diet, fit_lm_both),
                            mod_names = c("Exercise", "Food Intake", "Both"),
                            var_labels = c("exer" = "Exercise",
                                           "diet" = "Food"),
                            caption = "Parameter Estimates for Weight Loss Regressed on Exercise Frequency and Food Intake",
                            general_note = "Dependent variable is average weekly weight lost in 100s of grams.") %>% 
  flextable::footnote(part = "body",
                      i = c(2, 3), j = 1, 
                      value = flextable::as_paragraph(c("Weekly average of hours/day",
                                             "Daily average of 100s of calories above recommendation")))

tab_lm3
```

How to save to word document in the same folder as your R file.

```{r}
flextable::save_as_docx(tab_lm3,
                        path = "DH_ch3_tab_lm3.docx")
```



```{r}
apaSupp::tab_lms(list(fit_lm_both, fit_lm_three),
                 mod_names = c("Two Predictors", "Three Predictors"),
                 var_labels = c("exer" = "Exercise",
                                "diet" = "Food Intake",
                                "meta" = "Metabolism"),
                 caption = "Parameter Estimates for Weight Loss Regressed on Exercise Frequency, Food Intake, and Metabolic Rate",
                 general_note = "Dependent variable is average weekly weight lost in 100s of grams.  Exercise captures daily average of hours.  Food intake is the average of 100's of calories above the recommendation.  Metabolism is the metobalic rate.") 

```



### Visualization

```{r}
eq <- function(x, y){6 + 2*x -.5 *y}

xlims <- 0:4
ylims <- 0:8

persp(x = xlims,
      y = ylims,
      z = outer(xlims, ylims, eq),
      xlab = "Exercise",
      ylab = "Food Consumed",
      zlab = "Weight Loss",
      shade = .3,
      theta = 200, 
      phi = 15, 
      r = 5,
      d = .5,
      ticktype = 'detailed')
```



```{r}
interactions::interact_plot(model = fit_lm_both,
                            pred = diet,
                            modx = exer,
                            modx.values = 0:4,
                            x.label = "Food Consumption, 100s calories above 1000",
                            y.label = "Weight Loss, 100s of grams",
                            legend.main = "Exercise,\nhours/day") +
  theme_bw() 
```



```{r}
interactions::interact_plot(model = fit_lm_both,
                            pred = exer,
                            modx = diet,
                            modx.values = c(2, 4, 6, 8),
                            x.label = "Daily Exercise, hours",
                            y.label = "Weight Loss, 100s of grams",
                            legend.main = "Food Consumption\n100s calories") +
  theme_bw() 
```


```{r}
interactions::interact_plot(model = fit_lm_three,
                            pred = exer,
                            modx = diet,
                            mod2 = meta,
                            modx.values = c(8, 5, 2),
                            modx.labels = c("1800 cal",
                                            "1500 cal",
                                            "1200 cal"),
                            mod2.values = c(16, 22.75),
                            mod2.labels = c("Low Metabolic Rate\n(Q1 = 16.00)", 
                                            "High Metabolic Rate\n(Q3 = 22.75)"),
                            x.label = "Daily Exercise, hours",
                            y.label = "Weight Loss, grams/week",
                            legend.main = "Food Consumption") +
  theme_bw() +
  theme(legend.position = c(0, 1),
        legend.justification = c(-0.1, 1.1),
        legend.background = element_rect(color = "black"),
        legend.key.width = unit(2, "cm")) +
  scale_y_continuous(breaks = c(0, 5, 10, 15),
                     labels = c(0, 500, 1000, 1500))
```






## EFFECT SIZES

### Semipartial Correlation 

Unique contribution


```{r}
effectsize::r2_semipartial(fit_lm_both)
```

```{r}
effectsize::r2_semipartial(fit_lm_three)
```




### Eta Squared


```{r}
effectsize::eta_squared(fit_lm_both, partial = FALSE)
```

```{r}
effectsize::eta_squared(fit_lm_three, partial = FALSE)
```

```{r}
effectsize::eta_squared(fit_lm_both, partial = TRUE)
```

```{r}
effectsize::eta_squared(fit_lm_three, partial = TRUE)
```


### Standardized Regression Coefficients

```{r}
parameters::standardise_parameters(fit_lm_both)
```



```{r}
parameters::standardise_parameters(fit_lm_three)
```




## VARIANCE INFLATION FACTORS

```{r}
car::vif(fit_lm_both)
```

```{r}
car::vif(fit_lm_three)
```


## CONCLUSION: SPECIFIC QUESTIONS


```{r}
coef(fit_lm_both)
```


```{r}
confint(fit_lm_both)
```                               



$$
\widehat{loss} = 6 + 2(exercise) -0.5(food)
$$

Suppose an examination of the literature on diet, exercise, and weight loss led you to the following conclusions: 

1. People who eat the **minimum number of calories** to maintain good health and who **do not exercise** at all will lose how much?


```{r}
fit_lm_both %>% 
  emmeans::emmeans(~ exer + diet,
                   at = list(exer = 0,
                             diet = 0))

```

> The estimated marginal mean weight loss is 600 grams per week among thoes who eat the minimum number of calories to maintain good health and who do not exercise at, *b* = 6.00, 95% *CI* = [2.99, 9.01].



2. If food intake is held constant, then **each 1 hour of average daily exercise** leads to how much more weight loss?

```{r}
fit_lm_both %>% 
  emmeans::emmeans(~ exer + diet,
                   at = list(exer = 0:4))

```


> Holding food consumption constant, each additional hour of daily exercise is associated with 200 grams additional weight lost per week, *b* = 2.00, 95% *CI* = [1.21, 2.79].




3. If exercise is held constant, then **each one unit of food intake per day** (i.e., 100 calories) above the minimum to maintain good health translates to much weight gain?

```{r}
fit_lm_both %>% 
  emmeans::emmeans(~ diet,
                   at = list(diet = 0:4))

```

> Holding exercise constant, each additional 100 calories of food consumed daily is associated with 50 grams weight gained per week, *b* = -0.50, 95% *CI* = [1.21, 2.79]. 



4. If a person exercises 2 hours per week and eats 600 more calories than the minimum, how much weight would they loose weekly on average?


```{r}
fit_lm_both %>% 
  emmeans::emmeans(~ exer + diet,
                   at = list(exer = 2,
                             diet = 6))
```


> On average, 700 grams were lost per week amonth participants who exrcised 2 hours a week and consumed 6,600 more calories, 95% *CI* [572, 828]. 





